---
title: "[MicroService] 3. Microservice Architecture"

tags:
    - MicroService

toc: true
toc_sticky: true

date: 2024-01-13
last_modified_at: 2024-01-13
---

## 비즈니스 로직 (```Business Logic```) : 시스템이 목표로 하는 비즈니스 영역의 규칙, 흐름, 개념

> - 소프트웨어의 가치는? ```by Clean Architecture```
>   - 행위 기치 : 소프트웨어의 기능
>   - 구조 가치 : 소프트웨어의 아키텍처 → 소프트웨어를 ```Soft```하게 만드는 것
>
>   → 코드나 설계의 구조를 깔끔히 하는 대신 기능 구현만 목표하면, 엉망이 된 소프트웨어 대처에 더 많은 비용 발생
> 
> - 문제 영역에서 비즈니스 로직을 분석 및 이해하고, 프로그래밍 언어로 잘 표현하는 것이 개발자의 역할
>   - 기능이 정확하게 동작하는 것과 더불어, 이해하기 쉽고 변경하기 쉬운 시스템을 만드는 것

### 관심사의 분리 (```Separation of Concerns```) : 시스템의 각 영역이 처리하는 관심사가 분리해 관리되어야 함

- 각 영역은 고유의 관심사에 의해 분리되어 집중되어야 함 → 모듈화, 계층화
  - 비즈니스 로직은 어플리케이션의 핵심 영역이므로, 기술에 영향을 적게 받게 설계해야
  - 기술과 비즈니스 로직을 분리했을 때, 어플리케이션의 복잡성이 낮아지고 유지보수성이 높아짐
  - 비즈니스 로직을 모두가 이해할 수 있게 구조화된 객체 모델로 표현되어야 함

  → 유연하고 확장성 있는 ```MSA``` 시스템을 개발하려면, 마이크로서비스의 내부 구조를 어떻게 유연하게 만들지 고민해야!

## 데이터베이스 중심 아키텍처 (```Database Centric Architecture```) : 데이터 중심 서비스 구현

1. 특정한 관계형 데이터베이스에 의존한 데이터 모델링을 수행한다.
2. 물리 테이블 모델을 중심에 두고 어플리케이션을 구현한다. (예시 : ```SpringBoot Application```)
  - ```Controller```, ```Service```, ```DTO```, ```Repository & Entity```로 어플리케이션을 구성
  - ```SQL``` 매핑 프레임워크인 ```MyBatis```나 ```Java Persistence API```인 ```JPA```로 데이터를 처리

> 데이터베이스 중심 아키텍처에서 비즈니스 로직은 서비스에 존재해야 한다. 그러나,
>
> - 흐름 제어 로직만 서비스에 존재하고, 비즈니스 개념이나 규칙은 테이블이나 ```SQL``` 질의로 존재한다.
> - ```DTO```는 ```SQL``` 질의를 통해 정보를 가져오는 정보 묶음 (```Information Holder```)의 역할밖에 할 수 없다.
>

- 간단한 처리 로직의 경우에는 적합하나, 업무가 다양해지면 점점 복잡성을 제어할 수 없음
- 업무 개념이 특정 관계형 테이블 데이터베이스의 테이블로 표현되어, 데이터 질의어인 ```SQL```가 필요한 경우가 있음
- 서비스의 비즈니스 개념과 규칙이 대부분 데이터베이스에 표현 → 성능이 데이터베이스에 의존
  - 데이터가 늘어남에 따라 데이터베이스의 성능은 지속적으로 떨이짐
    - 데이터베이스 서버의 ```Scale-out```과 ```SQL``` 질의문 튜닝에 의존하게 됨

## ```MSA``` 시스템의 확장성과 유연성을 위한 내부 어플리케이션의 아키텍처 구조

- 클라우드의 풍부한 자원 환경에서는, 어플리케이션 자체의 성능보단 어플리케이션의 확장성과 유연성이 더 중요하다!

### 계층형 아키텍처 (```Layered Architecture```)

- 티어 (```Tear```) : 물리적인 장비나 서버 컴퓨터 등의 물리 계층
- 레이어 (```Layer```) : 물리적인 티어 내부에서 어플리케이션이 처리할 관심사를 구분하는 논리 계층
  - 프레젠테이션 (```Presentation```) : 화면 표현 및 전환 처리
  - 비즈니스 로직 (```Business Logic```) : 비즈니스 개념, 규칙, 흐름 제어
  - 데이터 액세스 (```Data Access```) : 데이터 처리

> 계층형 아키텍처를 개발하기 위하여 지켜야 할 규칙!
>
> - 상위 계층이 하위 계층을 호출하는 단방향성을 유지한다.
> - 상위 계층은 하위의 여러 계층을 모두 알 필요 없이 바로 밑의 근접 계층만을 활용한다.
> - 상위 계층이 하위 계층에 영향받지 않게 구성해야 한다.
> - 하위 계층은 자신을 사용하는 상위 계층을 알지 못하게끔 구성해야 한다.
> - 계층 간의 호출은 인터페이스를 통해 호출하는 것이 바람직하다.
>   - 구현 클래스에 직접 의존하지 않게끔 하여 약결합을 유지해야 한다.

- 의존성 역전의 원칙 (```DIP```) : '유연성이 극대화된 시스템은 코드 의존성이 구체가 아닌 추상에 의존한다.' → ```O```
- 개방 폐쇄의 원칙 (```OCP```) : '소프트웨어 객체는 확장에 열리되, 변경에 닫혀 있어야 한다.' → ```X```
  - 개체의 행위는 확장될 수 있지만, 이때 객체를 변경해서는 안된다. 그러나 상위 계층에서 하위 계층으로 제어의 흐름 (```Flow of Control```)이 흐르는 계층형 아키텍처에서 소스 코드의 의존성 또한 그 방향을 따를 수 밖에 없다.
  - 상위 계층이 하위 계층의 구체 클래스가 아닌 추상 인터페이스에 의존시키고 그 인터페이스의 구현체를 달리해 의존성을 줄이면서 다형성을 유지할 수 있지만, 인터페이스는 그 계층이 정의하는 추상 특성의 한계를 벗어날 수 없다.
  
  → 즉, 하위 계층의 유형이 추가되어 확장될 때, 닫혀 있어야 할 상위 계층이 하위 계층이 정의한 특성이 영향받는다!

### 헥사고날 아키텍처 (```Hexagonal Architecture```)



### 클린 아키텍처 (```Clean Architecture```)

